# 老师的：蒙特卡洛树搜索与五子棋AI算法相关资料

[TOC]
> **按住ctrl点带下划线的地方，可以直接在浏览器打开链接** 

- [x] ##### [蒙特卡洛树搜索入门介绍](https://blog.csdn.net/dQCFKyQDXYm3F8rB0/article/details/79767024) 


##### 五子棋规则
**Free-style Gomoku规则：无禁手，长连算胜
Standard Gomoku规则：无禁手，长连不算胜也不算负
Gomoku-Pro规则：黑方在天元放第一子，白方下第二子，黑方在中央5×5区域外放第三子，此后按Standard Gomoku规则继续进行。
Gomoku-Swap规则：假先方在棋盘任意下三手（二黑一白）假后方有二种选择：选黑/选白，此后按Standard Gomoku规则继续进行。
Gomoku-Swap2规则（目前Gomoku世锦赛的使用规则）：假先方在棋盘任意下三手（二黑一白）假后方有三种选择：选黑/选白/下四、五两手（一黑一白）再假先方选择黑或白，此后按Standard Gomoku规则继续进行。
Renju规则：黑棋禁手，白棋无禁手，黑棋禁手包括“三三”(包括“四三三”)、“四四”(包括“四四三”)、“长连”，即黑棋只能以“四三”取胜。五连与禁手同时形成时，判胜。四四禁手可能发生在一条直线上，三三不会**

##### [五子棋AI比赛网站，有比赛接口(Java,C++)](https://gomocup.org/)
[规则说明](https://www.beichengjiu.com/computerscience/338499.html)
freestyle: 20*20，无禁手，长连算赢
standard: 15*15，无禁手，长连不算赢也不算输
renju（连珠）: 15*15，黑棋有禁手

[连珠与五子棋网站](http://www.renju.net/) 

五子棋评分表算法
1. **下面这两个是一起的：** 
	+ [五子棋评分表算法](https://www.cnblogs.com/chaiwenjun000/p/5321115.html)：我认为可以用于做估值函数。蒙特卡洛算法中需要用到。可以通过判断棋子的思路改出这个
+ [人机版五子棋两种算法概述](https://blog.csdn.net/onezeros/article/details/5542379)：这个跟上面说的是一样的
	
2. [人机对战五子棋设计 ―― 算法设计](https://wenku.baidu.com/view/84db8debe2bd960590c677fb.html)：用的是估值法，跟上面差不多，而且棋盘还是10 * 10的，有参考价值但是不大

3. [人机对战五子棋经典算法](https://wenku.baidu.com/view/5a270a0979563c1ec5da71a5.html)：用C++写的，博弈树，极大极小算法和剪枝，感觉有用。但是代码的格式跟屎一样

4. [五子棋估值算法――maxuewei2的博客](https://www.cnblogs.com/maxuewei2/p/4825520.html)：用java实现的，very good，这个估值函数可以改一下直接用，算是最好的了。评论区里有个人基于这个弄了极大极小算法，我测试了一下，全篇标红，没啥参考价值。但是他这个思想可能会有用，可以先留一下代码。

5. [五子棋AI算法第二篇-极大极小值搜索算法](https://blog.csdn.net/lihongxun945/article/details/50625267)：用js写的，看不懂。而且他的演示程序全是黑棋。提供了新版教程的[链接](https://github.com/lihongxun945/myblog/labels/%E4%BA%94%E5%AD%90%E6%A3%8BAI%E6%95%99%E7%A8%8B%E7%AC%AC%E4%BA%8C%E7%89%88)和[仓库](https://github.com/lihongxun945/gobang)。这个链接里的内容和《PC游戏编程(人机博弈)》这本书的内容十分吻合。

   这个人是阿里的前端大佬，在“程序员与机器博弈”QQ群里（群号293355594，进群问题就说从知乎来的）。群里的资料感觉没啥用，都是其他语言写的，而且很多东西都是各种乱七八糟的格式，不知道是干嘛用的

   （2020-03-12：开始看《PC游戏编程》这本书了）
   
   **附上这本书和配套光盘的源码的链接：** 
   
   链接：https://pan.baidu.com/s/174PAAXSebFzRioR0vI4UOw 
   提取码：lrp3 
   复制这段内容后打开百度网盘手机App，操作更方便哦

- [ ] ##### [2005硕士论文-计算机五子棋博奕系统的研究与实现](https://www.docin.com/p-1402613865.html) 

这篇论文同样和《PC游戏编程》的内容很像，我感觉董红安肯定是参考了一些内容，但是没有引用

**后面的内容我还没看，感觉看董红安的论文得消化消化。所以只是把下面的东西加了超链接：** 

---

- [x] [机器博弈群里大佬推荐的案例](https://github.com/zhuliquan/tictactoe_mcts) 

- [x] [28 天自制你的 AlphaGo(五):蒙特卡洛树搜索(MCTS)基础――关于博弈论、蒙特卡洛搜索方法、AlphaGO的分析介绍](https://www.cnblogs.com/yifdu25/p/8303462.html)
  那么博弈论中，我们把zero-sum、perfect information、deterministic、discrete、sequential的游戏统称为Combinatorial Game，例如围棋、象棋等，而MCTS只能解决Combinatorial Game的问题。
  黑盒优化的算法也有很多，例如进化算法、贝叶斯优化、MCTS也算是，而这些算法都需要解决如何权衡探索和利用（Exploration and Exploitation）的问题。
  Minimax 搜索还有许多后续发展，如Alpha-beta 剪枝，以及更进一步的 Null Window / NegaScout / MTD(f) 等等。可惜这些方法更适合象棋等棋类，对于围棋的意义不大（除非已经接近终局）
  参见[“Alpha-Beta搜索的诸多变种”](http://www.xqbase.com/computer/advanced_intro2.html) 

https://download.csdn.net/download/dlutwuwei/2209524 （这个是个辣鸡，没啥用）

- [x] [UCT（信心上限树）算法](https://blog.csdn.net/u014397729/article/details/27366363) 

![img](F:\09.2020.02.07在桌面的东西\毕业论文相关\#00.所有关于毕业论文的MarkDown文档\20140528192717515.png)

- [x] [2019-04，自制AlphoGo，基于深度增强学习和蒙特卡洛树搜索的五子棋AI](https://zhuanlan.zhihu.com/p/59567014) 

- [x] [2018-03，AlphaZero实战：从零学下五子棋（附代码）](https://zhuanlan.zhihu.com/p/32089487) 

- [x] [AlphoZero版五子棋实现](https://ne7ermore.github.io/post/alpha-zero/) 


##### 蒙塔卡罗-五子棋，Java代码
- [ ] https://blog.csdn.net/bowean/article/details/79971547

- [ ] https://blog.csdn.net/liaogaobo2008/article/details/95033895



##### 相关参考文献 
- [ ] [2017-多种搜索算法的五子棋博弈算法研究](https://www.doc88.com/p-4092876895959.html) 

- [ ] 2012-A Survey of Monte Carlo Tree Search Method
    [中文翻译](https://blog.csdn.net/bowean/article/details/78808584)

**2018-Mastering the Game of Gomoku without Human Knowledge（牛皮，老师早就看到了）** 
2018-AlphaGomoku: An AlphaGo-based Gomoku Artificial Intelligence using Curriculum Learning
2014-Evolving Gomoku solver by genetic algorithm

---

# 我自己找的文章：

## 扩展文章1：五子棋大师（已上架）

iTunes 地址：https://itunes.apple.com/cn/app/id1264708584?mt=8

Developed by [@张添](https://github.com/genosage) and [@王唱畅](https://github.com/Kesoyuh)

### 一、游戏截图

[![img](https://github.com/Kesoyuh/Gomoku/raw/master/Screenshots/Screenshot1.png)](https://github.com/Kesoyuh/Gomoku/blob/master/Screenshots/Screenshot1.png) [![img](https://github.com/Kesoyuh/Gomoku/raw/master/Screenshots/Screenshot3.png)](https://github.com/Kesoyuh/Gomoku/blob/master/Screenshots/Screenshot3.png) [![img](https://github.com/Kesoyuh/Gomoku/raw/master/Screenshots/Screenshot2.png)](https://github.com/Kesoyuh/Gomoku/blob/master/Screenshots/Screenshot2.png)

[![img](https://github.com/Kesoyuh/Gomoku/raw/master/Screenshots/single.gif)](https://github.com/Kesoyuh/Gomoku/blob/master/Screenshots/single.gif)

[![img](https://github.com/Kesoyuh/Gomoku/raw/master/Screenshots/LAN.gif)](https://github.com/Kesoyuh/Gomoku/blob/master/Screenshots/LAN.gif)


### 二、功能介绍

#### 1. 人机对战

在人机模式下，AI 共有三种难度可供选择。简单难度的 AI 由贪心算法实现，中等和困难难度的 AI 基于极小化极大算法实现。算法通过多种方式优化，在困难难度下，博弈树深度可达8层。

##### 1.1 贪心算法

贪心算法的主要思路是，评价当前棋局中所有可以下的位置，依据一个评分表对该位置进行打分，然后随机选取一个分数最高的位置落子。对于五子棋来说，我们把五个连续的位置称为五元组，对于一个可以下的位置来说，我们对于所有包含它的五元组，根据五元组中黑棋和白棋的数量进行评分，这个位置的最终得分就是所有这些五元组的评分的和。下面是游戏中所用的针对黑棋的评分表：

```
// tuple is empty  
GGTupleTypeBlank = 7,  
// tuple contains a black chess  
GGTupleTypeB = 35,  
// tuple contains two black chesses  
GGTupleTypeBB = 800,  
// tuple contains three black chesses  
GGTupleTypeBBB = 15000,  
// tuple contains four black chesses  
GGTupleTypeBBBB = 800000,  
// tuple contains a white chess  
GGTupleTypeW = 15,  
// tuple contains two white chesses  
GGTupleTypeWW = 400,  
// tuple contains three white chesses  
GGTupleTypeWWW = 1800,  
// tuple contains four white chesses  
GGTupleTypeWWWW = 100000,  
// tuple contains at least one black and at least one white  
GGTupleTypePolluted = 0
```

##### 1.2 极小化极大算法

对于五子棋这种零和游戏，极小化极大算法是最常用的算法，维基百科上已有详细介绍：[极小化极大算法](https://en.wikipedia.org/wiki/Minimax)，在此不再详细解释。

游戏在博弈树搜索的基础之上，进行了许多优化，用于提升搜索树的深度：

**Alpha-Beta 剪枝**，维基百科上的详细介绍：[Alpha-Beta 剪枝](https://en.wikipedia.org/wiki/AlphaCbeta_pruning)。

**启发式搜索函数**：在博弈树中，对于每一层的节点来说，如果粗略的按照好坏对其进行一个排序，Alpha-Beta 算法就可以减去更多的节点，游戏中，我们用贪心算法对于每一个节点上一步所下的位置进行评分，根据这个评分对节点进行排序，从而进一步提升博弈树搜索的效率。

**缩减子节点**：游戏中所使用的贪心算法效果很好，基本可以保证最优解在评分前十的点中，所以我们可以缩减博弈树中的每个节点的子节点数量，只取评分前十的点，这大大的减少了节点的数量，并且将博弈树的搜索深度提升到了8层。

**迭代加深**：在游戏中有时候会发生如下情况：明明 AI  已经快要胜利，但是会选择一些其他的点并且多下几部才取胜，看起来像是在调戏玩家，实际上这是由于在博弈树中已经找到一个解之后便没有考虑其他层数较小的解。归根结底是因为极小化极大算法是深度优先搜索，不保证可以找到最优解。对此我们使用迭代加深博弈树搜索深度的方法，确保 AI 可以返回最优解。

#### 2. 双人同屏

此模式支持两位玩家在同一手机上一同下棋。

#### 3. 联机游戏

在局域网联机模式下，两台处于同一子网的手机可通过网络进行连接并一同下棋。游戏使用[Bonjour](https://developer.apple.com/bonjour/)（[维基页面](https://zh.wikipedia.org/wiki/Bonjour)）作为局域网内广播服务（棋局）和寻找棋局的解决方案。当找到棋局后，游戏使用[GCDAsyncSocket](https://github.com/robbiehanson/CocoaAsyncSocket)来建立网络连接，进而进行网络通信。

游戏定义了网络间包的类型与内容，以确保通信的简介与准确。包的类型分为三中：下棋，悔棋和重赛。当游戏的任何一方希望进行悔棋或重赛时，需得到对方同意。因此网络包有以下定义：

```
// GGPacket.h

......

// 包类型
typedef NS_ENUM(NSInteger, GGPacketType) {
	// 未知类型
    GGPacketTypeUnknown,
    // 下棋
    GGPacketTypeMove,
    // 重赛
    GGPacketTypeReset,
    // 悔棋
    GGPacketTypeUndo
};

// 包具体动作
typedef NS_ENUM(NSInteger, GGPacketAction) {
    GGPacketActionUnknown,
    // 重赛请求/同意/拒绝
    GGPacketActionResetRequest,
    GGPacketActionResetAgree,
    GGPacketActionResetReject,
    // 悔棋请求/同意/拒绝
    GGPacketActionUndoRequest,
    GGPacketActionUndoAgree,
    GGPacketActionUndoReject
};

@interface GGPacket : NSObject

// data用来在下棋类型的包中存放棋的坐标
@property (strong, nonatomic) id data;
@property (assign, nonatomic) GGPacketType type;
@property (assign, nonatomic) GGPacketAction action;

......

@end
```

#### 4. 其他功能

##### 4.1 界面设计

由于没有美工，游戏没有华丽的特效，但整体界面依然不失简洁优雅大方，五子棋的棋盘使用 Core Graphics 画出，并使用 NSTimer 对游戏双方进行计时，落子指示图标也可以方便的提醒玩家最新落子。

##### 4.2 游戏设置

在设置界面可以设置游戏的难度，游戏的音乐以及音效，玩家的偏好设置通过 NSUsersDefaults 进行存储。游戏的音乐使用 AVAudioPlayer 进行播放与控制。

### 三、总结

该五子棋游戏具有人机、人人、联机等多种功能，并且棋力不俗，在实际测试中可以轻松战胜大多数网络上的五子棋程序。

下面是我们的五子棋与 Google 搜索 Gomoku 排名第一的[五子棋游戏](http://gomoku.yjyao.com/)进行对战的截图：

[![img](https://github.com/Kesoyuh/Gomoku/raw/master/Screenshots/%E5%85%88%E6%89%8B%E8%83%9C.png)](https://github.com/Kesoyuh/Gomoku/blob/master/Screenshots/先手胜.png)

先手情况下，轻松取胜。

[![img](https://github.com/Kesoyuh/Gomoku/raw/master/Screenshots/%E5%90%8E%E6%89%8B%E8%83%9C.png)](https://github.com/Kesoyuh/Gomoku/blob/master/Screenshots/后手胜.png)

后手情况下，经过一番鏖战，取得胜利。

下面是与 Github 上面有名的五子棋程序 [Gobang](https://github.com/lihongxun945/gobang) 进行对战的截图：

[![img](https://github.com/Kesoyuh/Gomoku/raw/master/Screenshots/%E5%AF%B9%E6%88%98%20GoBang.png)](https://github.com/Kesoyuh/Gomoku/blob/master/Screenshots/对战 GoBang.png)

由于 GoBang 不能设置先后手，这是在我方后手的情况下，最终取得了胜利。

### 四、参考资料

[Core Graphics](https://www.raywenderlich.com/90690/modern-core-graphics-with-swift-part-1)

[五子棋项目参考1](https://github.com/dadahua/GoBangProject)

[五子棋项目参考2](http://www.jianshu.com/p/a2f98c138648)

[五子棋AI设计](http://blog.csdn.net/pi9nc/article/details/10858411)

[如何设计一个还可以的五子棋AI](https://kimlongli.github.io/2016/12/14/如何设计一个还可以的五子棋AI/)

**[五子棋AI算法系列](http://blog.csdn.net/lihongxun945/article/details/50622880)**

**[人机版五子棋两种算法概述](http://blog.csdn.net/onezeros/article/details/5542379)**

**[计算机五子棋博奕系统的研究与实现](http://www.taodocs.com/p-20517708.html)**

**[Gomoku AI Player](https://www.cs.cf.ac.uk/PATS2/@archive_file?c=&p=file&p=526&n=final&f=1-1224795-final-report.pdf)**

**[十四步实现拥有强大AI的五子棋游戏](http://www.cnblogs.com/goodness/archive/2010/05/27/1745756.html)**

**[Creating a Game with Bonjour and GCDAsyncUdpSocket - Server and Client Setup](https://code.tutsplus.com/tutorials/creating-a-game-with-bonjour-client-and-server-setup--mobile-16233)**

**[Creating a Game with Bonjour and GCDAsyncUdpSocket - Sending Data](https://code.tutsplus.com/tutorials/creating-a-game-with-bonjour-sending-data--mobile-16437)**